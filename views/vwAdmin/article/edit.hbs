{{#section 'js'}}
<script src="https://cdn.ckeditor.com/ckeditor5/39.0.1/classic/ckeditor.js"></script>
<script>
    // Khởi tạo CKEditor
    ClassicEditor
        .create(document.querySelector('#editor'), {
            ckfinder: {
                // Tùy chọn upload hình ảnh (nếu có server xử lý upload)
                uploadUrl: '/upload-image'
            },
            toolbar: ['heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote', 'imageUpload', 'insertTable', 'mediaEmbed', 'undo', 'redo'],
            mediaEmbed: {
                previewsInData: true
            }
        })
        .then(editor => {
            editorInstance = editor;

            // Trước khi submit form, cập nhật dữ liệu CKEditor vào textarea ẩn
            document.querySelector('form').addEventListener('submit', () => {
                document.querySelector('#content').value = editorInstance.getData();
            });
        })
        .catch(error => {
            console.error('Lỗi khi khởi tạo CKEditor:', error);
        });

    document.querySelector('form').addEventListener('submit', function () {
        // Kiểm tra nếu checkbox is_premium được chọn
        if (document.querySelector('#isPremium').checked) {
            document.querySelector('input[name="is_premium"]').value = 'true';
        } else {
            document.querySelector('input[name="is_premium"]').value = 'false';
        }
    });
</script>
{{/section}}


<div class="container mt-3" style="margin-bottom: 100px;">
    <h1>Phân hệ đăng bài viết</h1>
    <form action="" method="post" enctype="multipart/form-data">

        <div class="form-group">
            <label>Tiêu đề:</label>
            <input type="text" name="title" required class="form-control"><br><br>
        </div>
        <div class="form-group">
            <label>Tác giá</label>
            <input type="text" name="author" required class="form-control"><br><br>
        </div>
        <div class="form-group">
            <label>Tóm tắt:</label>
            <textarea name="abstract" rows="3" required class="form-control"></textarea><br><br>
        </div>

        <label>Nội dung:</label>
        <div id="editor"></div><br>

        <label>Chuyên mục:</label>
        <select name="category_id" required>
            {{#each categories}}
            <option value="{{id}}">{{category_name}}</option>
            {{/each}}
        </select><br><br>

        <div class="form-group">
            <label for="isPremium">Is premium</label>
            <input type="checkbox" name="is_premium" id="isPremium" value="true">
            <!-- Thêm thẻ input ẩn để gửi giá trị false nếu checkbox không được chọn -->
            <input type="hidden" name="is_premium" value="false">
        </div>

        <button type="submit" class="btn btn-primary">
            Đăng bài
        </button>

        <!-- Thẻ textarea ẩn để lưu dữ liệu từ CKEditor -->
        <textarea id="content" name="content" style="display:none;"></textarea>
    </form>
</div>