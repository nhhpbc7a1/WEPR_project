<div class="container">
  {{#if showErrors}}
  <div class="alert alert-danger" role="alert">
    Sai tên tài khoản hoặc mật khẩu!
  </div>
  {{/if}}
  <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; display: flex; background: #fff; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
    <!-- Cột bên trái -->
    <div style="width: 50%; padding: 30px; border-right: 1px solid #ddd;">
      <h2 style="color: #333; font-size: 24px; margin-bottom: 20px; color:rgb(74, 98, 138); font-weight:600"; class="text-center">Đăng nhập Trendlens</h2>
      <p style="font-size: 14px; color: #555; margin-bottom: 20px;">Để sử dụng đầy đủ tính năng đọc báo và tham gia cộng đồng hơn 8 triệu thành viên</p>
      <form id="frmLogin" action="/account/login" method="POST">
        <div style="margin-bottom: 20px;">
          <input id="txtUsername" type="text" name="username" placeholder="Nhập username" required
            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; box-sizing: border-box;" >
        </div>
        <div style="margin-bottom: 20px;">
          <input id="txtPassword" type="password" name="raw_password" placeholder="Nhập mật khẩu" required
            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; box-sizing: border-box;" >
        </div>
        <button type="submit" class="mb-3"
          style="width: 100%; padding: 10px; background-color:rgb(74, 98, 138); color: white; font-size: 18px; font-weight:bold ; border: none; border-radius: 4px; cursor: pointer;">
          Đăng nhập
        </button>
        <div class="footer text-center">
          <p>Chưa có tài khoản? <a href="/signup">Tạo tài khoản</a></p>
        </div>
      </form>
      <p style="font-size: 12px; color: #888; margin-top: 15px;">Bạn tạo tài khoản là đồng ý với
        <a href="#" style="color: #007bff; text-decoration: none;">quy định</a>,
        <a href="#" style="color: #007bff; text-decoration: none;">điều khoản sử dụng</a>
        và <a href="#" style="color: #007bff; text-decoration: none;">chính sách bảo mật</a> của Trendlens.
      </p>
    </div>

    <!-- Cột bên phải -->
    <div style="width: 50%; padding: 30px; background-color: #f8f9fa;">
      <h2 style="color: #333; font-size: 24px; margin-bottom: 20px;color:rgb(74, 98, 138); font-weight:500"; class="text-center mb-5">Đăng nhập tài khoản với</h2>
      <label for=""></label>
      <div class="mt-2">
        <button
          style="width: 100%; padding: 10px; margin-bottom: 15px; color: rgb(1, 101, 225); font-size: 16px; font-weight:bold; border: 1px solid rgb(1, 101, 225); border-radius: 4px; cursor: pointer;">
          <img src="/public/images/icon/icons8-facebook-50.png" alt="" width="30px">
          Facebook
        </button>
        <button
          style="width: 100%; padding: 10px; margin-bottom: 15px; color: rgb(226, 24, 24); font-size: 16px; font-weight:bold; border: 1px solid rgb(226, 24, 24); border-radius: 4px; cursor: pointer;">
          <img src="/public/images/icon/icons8-google-50.png" alt="" width="30px">
          Facebook
        </button>

        <!-- Nút Google Login (Google Identity Services sẽ render nó) -->
        {{!-- <div id="rgb(226, 24, 24)" style="padding: 10px; margin-bottom: 15px; color: rgb(51, 49, 49); font-size: 16px;border: 1px solid rgb(226, 24, 24);font-weigth:bold; border: none; border-radius: 4px;"></div> --}}

        <!-- Form ẩn để xử lý Google Login -->
        {{!-- <form id="frmGoogleLogin" action="/account/auth/google" method="POST" style="display: none;">
          <input type="hidden" name="id_token" id="google-id-token">
        </form> --}}
        <button
          style="width: 100%; padding: 10px; font-size: 16px;font-weight:bold; border: 1px solid black; border-radius: 4px; cursor: pointer;">
          <img src="/public/images/icon/icons8-apple-40.png" alt="" width="30px">
          Apple
        </button>
      </div>
    </div>
  </div>
</div>

{{#section 'js'}}
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
  // Xử lý phản hồi từ Google Identity Services
  function handleCredentialResponse(response) {
    console.log('Encoded JWT ID token:', response.credential);

    // Gửi token tới backend
    const idTokenInput = document.getElementById('google-id-token');
    idTokenInput.value = response.credential;

    const googleLoginForm = document.getElementById('frmGoogleLogin');
    googleLoginForm.submit();
  }

  // Khởi tạo Google Identity Services khi trang tải xong
  window.onload = function () {
    google.accounts.id.initialize({
      client_id: '27591522593-3vh6610g3n58hreubc5o3eatbv52ohi7.apps.googleusercontent.com',
      callback: handleCredentialResponse
    });

    // Hiển thị nút Google Sign-In
    google.accounts.id.renderButton(
      document.getElementById('google-login'),
      { 
        theme: '',  // Chỉ hiển thị nút outline mà không có ảnh đại diện
        size: 'large',     // Kích thước lớn cho nút
        text: 'Đăng nhập bằng google', // Hiển thị "Sign in with Google"
        width: '100%'   
      }
    );
  };

  // Xử lý form đăng nhập thông thường
  document.getElementById('frmLogin').addEventListener('submit', function (event) {
    const username = document.getElementById('txtUsername').value.trim();
    const password = document.getElementById('txtPassword').value.trim();

    if (!username || !password) {
      alert('Vui lòng nhập đầy đủ thông tin.');
      event.preventDefault(); // Ngăn form gửi dữ liệu
    }
  });
</script>
{{/section}}
